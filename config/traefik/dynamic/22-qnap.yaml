# config/traefik/dynamic/22-qnap.yaml
http:
  middlewares:
    security-headers-qnap:
      headers:
        stsSeconds: 31536000
        stsIncludeSubdomains: true
        stsPreload: true
        contentTypeNosniff: true
        browserXssFilter: true
        frameDeny: false
        customFrameOptionsValue: "SAMEORIGIN"

    chain-qnap:
      chain:
        middlewares:
          - allowlist-default
          - security-headers-qnap

  serversTransports:
    insecure-skip:
      insecureSkipVerify: true

  routers:
    qnap:
      rule: 'Host(`q.{{ env "DOMAIN" }}`)'
      entryPoints: ["websecure"]
      middlewares: ["chain-qnap"]
      service: qnap
      tls: {}

  services:
    qnap:
      loadBalancer:
        servers:
          - url: "https://192.168.222.10:443"
        serversTransport: "insecure-skip"